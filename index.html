<!DOCTYPE html>
<html>
<head>
    <title>üïØÔ∏è –°–≤–µ—á–Ω–æ–π –º–∞–≥–∞–∑–∏–Ω</title>
    <meta charset="utf-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            padding: 20px;
            background: #f8f4e9;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ */
        .tab {
            display: none;
            padding: 10px;
        }
        
        .active {
            display: block;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –≤–∫–ª–∞–¥–æ–∫ */
        .tabs-header {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: white;
            font-size: 16px;
            cursor: pointer;
        }
        
        .tab-btn.active {
            background: #e6b89c;
            color: white;
            font-weight: bold;
        }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ */
        .candle {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .candle h3 {
            margin: 0 0 10px 0;
            color: #8b4513;
        }
        
        .price {
            font-size: 20px;
            font-weight: bold;
            color: #d2691e;
            margin: 10px 0;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        button {
            background: #d2691e;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        button:hover {
            background: #8b4513;
        }
        
        /* –ö–æ—Ä–∑–∏–Ω–∞ */
        .cart-item {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .total {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: #8b4513;
        }
        
        /* –û–ø–ª–∞—Ç–∞ */
        .payment-btn {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 15px;
            font-size: 18px;
        }
        
        #orderResult {
            text-align: center;
            padding: 20px;
            background: #e6ffed;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }
    </style>
</head>
<body>
    <h1>üïØÔ∏è –ú–∞–≥–∞–∑–∏–Ω —Å–≤–µ—á–µ–π</h1>
    
    <!-- –ö–Ω–æ–ø–∫–∏ –≤–∫–ª–∞–¥–æ–∫ -->
    <div class="tabs-header">
        <button class="tab-btn active" onclick="showTab('catalog')">–ö–∞—Ç–∞–ª–æ–≥</button>
        <button class="tab-btn" onclick="showTab('cart')">–ö–æ—Ä–∑–∏–Ω–∞</button>
        <button class="tab-btn" onclick="showTab('payment')">–û–ø–ª–∞—Ç–∞</button>
    </div>
    
    <!-- –ö–ê–¢–ê–õ–û–ì -->
    <div id="catalog" class="tab active">
        <div id="catalogList">
            <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
        </div>
    </div>
    
    <!-- –ö–û–†–ó–ò–ù–ê -->
    <div id="cart" class="tab">
        <div id="cartList">
            –ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞
        </div>
        <div id="cartTotal" class="total">–ò—Ç–æ–≥–æ: 0 ‚ÇΩ</div>
        <button onclick="showTab('payment')">üí≥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ</button>
    </div>
    
    <!-- –û–ü–õ–ê–¢–ê -->
    <div id="payment" class="tab">
        <h2>üí≥ –û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</h2>
        <div id="paymentTotal" class="total">0 ‚ÇΩ</div>
        
        <button class="payment-btn" onclick="payByCard()">üí≥ –ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω</button>
        <button class="payment-btn" onclick="payBySBP()">üì± –°–ë–ü (–ø–æ QR-–∫–æ–¥—É)</button>
        <button class="payment-btn" onclick="payByCrypto()">‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π</button>
        
        <div id="orderResult">
            <h3>‚úÖ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h3>
            <p id="orderDetails"></p>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Å–≤–µ—á–∞—Ö
        const candles = [
            {id: 1, name: "–í–∞–Ω–∏–ª—å–Ω–∞—è —Å–≤–µ—á–∞", price: 500, emoji: "üïØÔ∏è"},
            {id: 2, name: "–õ–∞–≤–∞–Ω–¥–æ–≤–∞—è —Å–≤–µ—á–∞", price: 600, emoji: "üå∏"},
            {id: 3, name: "–•–≤–æ–π–Ω–∞—è —Å–≤–µ—á–∞", price: 550, emoji: "üå≤"},
            {id: 4, name: "–¶–∏—Ç—Ä—É—Å–æ–≤–∞—è —Å–≤–µ—á–∞", price: 450, emoji: "üçä"},
            {id: 5, name: "–®–æ–∫–æ–ª–∞–¥–Ω–∞—è —Å–≤–µ—á–∞", price: 650, emoji: "üç´"},
            {id: 6, name: "–ú–æ—Ä—Å–∫–∞—è —Å–≤–µ—á–∞", price: 700, emoji: "üåä"}
        ];
        
        // –ö–æ—Ä–∑–∏–Ω–∞
        let cart = [];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤–∫–ª–∞–¥–∫—É
        function showTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.textContent.includes(tabName === 'catalog' ? '–ö–∞—Ç–∞–ª–æ–≥' : 
                                           tabName === 'cart' ? '–ö–æ—Ä–∑–∏–Ω–∞' : '–û–ø–ª–∞—Ç–∞')) {
                    btn.classList.add('active');
                }
            });
            
            // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (tabName === 'cart') {
                updateCartDisplay();
            } else if (tabName === 'payment') {
                updatePaymentTotal();
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥
        function loadCatalog() {
            const catalogList = document.getElementById('catalogList');
            catalogList.innerHTML = '';
            
            candles.forEach(candle => {
                const div = document.createElement('div');
                div.className = 'candle';
                div.innerHTML = `
                    <h3>${candle.emoji} ${candle.name}</h3>
                    <div class="price">${candle.price} ‚ÇΩ</div>
                    <button onclick="addToCart(${candle.id})">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                `;
                catalogList.appendChild(div);
            });
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
        function addToCart(id) {
            const candle = candles.find(c => c.id === id);
            const item = cart.find(i => i.id === id);
            
            if (item) {
                item.quantity += 1;
            } else {
                cart.push({
                    id: id,
                    name: candle.name,
                    price: candle.price,
                    emoji: candle.emoji,
                    quantity: 1
                });
            }
            
            alert(`–î–æ–±–∞–≤–ª–µ–Ω–æ: ${candle.name}`);
            updateCartDisplay();
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
        function updateCartDisplay() {
            const cartList = document.getElementById('cartList');
            const cartTotal = document.getElementById('cartTotal');
            
            if (cart.length === 0) {
                cartList.innerHTML = '–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞';
                cartTotal.textContent = '–ò—Ç–æ–≥–æ: 0 ‚ÇΩ';
                return;
            }
            
            let html = '';
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                html += `
                    <div class="cart-item">
                        ${item.emoji} ${item.name} 
                        <br>${item.price} ‚ÇΩ √ó ${item.quantity} = ${itemTotal} ‚ÇΩ
                        <button onclick="removeFromCart(${item.id})">‚ùå –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
            });
            
            cartList.innerHTML = html;
            cartTotal.textContent = `–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ`;
        }
        
        // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCartDisplay();
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å—É–º–º—É –¥–ª—è –æ–ø–ª–∞—Ç—ã
        function updatePaymentTotal() {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('paymentTotal').textContent = `${total} ‚ÇΩ`;
        }
        
        // –û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π (–ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ)
        function payByCard() {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
            // –î–ª—è –¥–µ–º–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
            
            document.getElementById('orderDetails').textContent = 
                `–û–ø–ª–∞—á–µ–Ω–æ ${total} ‚ÇΩ –∫–∞—Ä—Ç–æ–π. –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!`;
            document.getElementById('orderResult').style.display = 'block';
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram –±–æ—Ç–∞
            sendOrderToBot(total, 'card');
            
            // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
            cart = [];
            updateCartDisplay();
        }
        
        // –û–ø–ª–∞—Ç–∞ –°–ë–ü
        function payBySBP() {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º QR-–∫–æ–¥ (–¥–ª—è –¥–µ–º–æ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç)
            alert(`QR-–∫–æ–¥ –¥–ª—è –æ–ø–ª–∞—Ç—ã ${total} ‚ÇΩ\n\n` +
                  `–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –∫–æ–¥ –≤ –±–∞–Ω–∫–æ–≤—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏\n` +
                  `–ò–ª–∏ –ø–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –Ω–æ–º–µ—Ä: +79001234567\n\n` +
                  `–í –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —É–∫–∞–∂–∏—Ç–µ: –°–≤–µ—á–∏`);
            
            document.getElementById('orderDetails').textContent = 
                `–û–∂–∏–¥–∞–µ–º –æ–ø–ª–∞—Ç—É ${total} ‚ÇΩ –ø–æ –°–ë–ü`;
            document.getElementById('orderResult').style.display = 'block';
            
            sendOrderToBot(total, 'sbp');
            cart = [];
        }
        
        // –û–ø–ª–∞—Ç–∞ –∫—Ä–∏–ø—Ç–æ–π
        function payByCrypto() {
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const btcAmount = (total / 5000000).toFixed(8);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥—Ä–µ—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã
            alert(`–ê–¥—Ä–µ—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã:\n\n` +
                  `BTC: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa\n` +
                  `–°—É–º–º–∞: ${btcAmount} BTC\n\n` +
                  `–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"`);
            
            document.getElementById('orderDetails').textContent = 
                `–û–∂–∏–¥–∞–µ–º –æ–ø–ª–∞—Ç—É ${btcAmount} BTC`;
            document.getElementById('orderResult').style.display = 'block';
            
            sendOrderToBot(total, 'crypto');
            cart = [];
        }
        
        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ –≤ Telegram –±–æ—Ç–∞
        function sendOrderToBot(total, method) {
            const order = {
                type: 'order',
                cart: cart,
                total: total,
                payment: method,
                time: new Date().toLocaleString('ru-RU')
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞
            Telegram.WebApp.sendData(JSON.stringify(order));
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                Telegram.WebApp.close();
            }, 3000);
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        window.onload = function() {
            loadCatalog();
        };
    </script>
</body>
</html>
